{% extends 'base.html' %}

{% block title %}–ú–æ–∏ –æ—Ç–∫–ª–∏–∫–∏ - Marketplace{% endblock %}

{% block content %}
<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
<div class="page-header mb-5">
    <div>
        <h1 class="display-6 fw-bold mb-2">–ú–æ–∏ –æ—Ç–∫–ª–∏–∫–∏</h1>
        <p class="text-muted mb-0">–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –æ—Ç–∫–ª–∏–∫–Ω—É–ª–∏—Å—å</p>
    </div>
</div>

<!-- –°–ø–∏—Å–æ–∫ –æ—Ç–∫–ª–∏–∫–æ–≤ -->
{% if offers %}
    <div class="row g-4">
        {% for offer in offers %}
            <div class="col-lg-6 col-md-12">
                <div class="offer-card">
                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
                    <div class="offer-header mb-3">
                        <div>
                            <h4 class="mb-2">
                                <a href="{% url 'marketplace:task_detail' offer.task.id %}" class="text-decoration-none" style="color: var(--text-main);">
                                    {{ offer.task.title }}
                                </a>
                            </h4>
                            <div class="d-flex gap-2 flex-wrap mb-2">
                                <span class="badge badge-category">{{ offer.task.category.name }}</span>
                                <span class="task-location">
                                    <i class="bi bi-geo-alt"></i> {{ offer.task.city }}
                                </span>
                                <span class="badge badge-status badge-{{ offer.task.status }}">
                                    {{ offer.task.get_status_display }}
                                </span>
                            </div>
                        </div>
                        <span class="badge 
                            {% if offer.status == 'accepted' %}bg-success
                            {% elif offer.status == 'rejected' %}bg-danger
                            {% elif offer.status == 'cancelled' %}bg-secondary
                            {% else %}bg-warning{% endif %}">
                            {{ offer.get_status_display }}
                        </span>
                    </div>
                    
                    <!-- –¶–µ–Ω–∞ -->
                    <div class="offer-price mb-3">
                        üí∞ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞: <strong>{{ offer.proposed_price }}</strong>
                    </div>
                    
                    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ -->
                    <div class="offer-message mb-3">
                        üí¨ {{ offer.message|truncatewords:30 }}
                    </div>
                    
                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞—á–µ -->
                    <div class="mb-3">
                        <small class="text-muted">
                            <i class="bi bi-person"></i> –ö–ª–∏–µ–Ω—Ç: {{ offer.task.client.username }}
                        </small>
                    </div>
                    
                    <!-- –î–∞—Ç–∞ -->
                    <div class="offer-date mb-3">
                        <i class="bi bi-clock"></i> –û—Ç–∫–ª–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω {{ offer.created_at|date:"d.m.Y –≤ H:i" }}
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ -->
                    <div class="mt-3">
                        <a href="{% url 'marketplace:task_detail' offer.task.id %}" class="btn btn-accent-outline w-100">
                            <i class="bi bi-arrow-right"></i> –ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–¥–∞—á–µ
                        </a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="empty-state">
        <div class="empty-state-icon mb-3">
            <i class="bi bi-inbox display-1 text-muted"></i>
        </div>
        <h3 class="text-muted">–û—Ç–∫–ª–∏–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
        <p class="text-muted">–í—ã –µ—â–µ –Ω–µ –æ—Ç–∫–ª–∏–∫–∞–ª–∏—Å—å –Ω–∏ –Ω–∞ –æ–¥–Ω—É –∑–∞–¥–∞—á—É. –ù–∞–π–¥–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é –∑–∞–¥–∞—á—É –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–≤–æ–π –æ—Ç–∫–ª–∏–∫!</p>
        <a href="{% url 'marketplace:tasks_list' %}" class="btn btn-accent mt-3">
            <i class="bi bi-search"></i> –ù–∞–π—Ç–∏ –∑–∞–¥–∞—á–∏
        </a>
    </div>
{% endif %}
{% endblock %}

