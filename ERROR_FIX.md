# Исправление ошибки 500

## Возможные причины и решения

### 1. Проблема с шаблоном base.html
**Исправлено**: Добавлена проверка `{% if request %}` перед использованием `request.get_full_path`

### 2. Проблема с AI service
**Исправлено**: 
- Добавлена обработка разных форматов ответа от Gemini
- Добавлена проверка на пустой ответ
- Улучшена обработка ошибок

### 3. Проверка настроек
Выполните:
```bash
cd backend
python3 manage.py check
python3 manage.py migrate
```

### 4. Проверка логов
Если ошибка 500 все еще возникает, проверьте логи Django:
- В development: смотрите вывод в консоли
- В production: проверьте логи Render

### 5. Частые проблемы

#### Проблема с импортами
Убедитесь что все зависимости установлены:
```bash
pip install -r requirements.txt
```

#### Проблема с базой данных
Примените миграции:
```bash
python3 manage.py migrate
```

#### Проблема с статикой
Соберите статику:
```bash
python3 manage.py collectstatic --noinput
```

### 6. Отладка
Включите DEBUG=True временно для просмотра полной ошибки:
```python
# settings.py
DEBUG = True
```

**ВНИМАНИЕ**: Не оставляйте DEBUG=True в production!

### 7. Проверка конкретной ошибки
Если знаете URL где происходит ошибка, проверьте:
- Существует ли view для этого URL
- Правильно ли настроены URL patterns
- Есть ли необходимые данные в базе

